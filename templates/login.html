<!DOCTYPE html>
<html lang="tr">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">

   <!--=============== REMIXICONS ===============-->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css" crossorigin="">
   <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <!--=============== CSS ===============-->
   <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

   <title>Giriş Yap - Kanban Pro</title>
</head>
<body>
   <!-- Navigation Back to Homepage -->
   <div style="position: fixed; top: 20px; left: 20px; z-index: 1000;">
      <a href="{{ url_for('homepage') }}" class="back-to-home">
         <i class="fas fa-arrow-left"></i>
         Ana Sayfa
      </a>
   </div>

   <!-- Dark Mode Toggle - Fixed Position -->
   <div style="position: fixed; top: 20px; right: 20px; z-index: 1000;">
      <div class="theme-toggle-container">
         <button onclick="toggleTheme()" 
                 class="theme-toggle"
                 title="Karanlık/Aydınlık Mod">
            <div class="toggle-track">
               <div class="toggle-thumb">
                  <i class="fas fa-sun sun-icon"></i>
                  <i class="fas fa-moon moon-icon"></i>
               </div>
            </div>
         </button>
      </div>
   </div>

   <div class="login">
      <img src="{{ url_for('static', filename='img/login-bg.png') }}" alt="image" class="login__bg">

      <form action="{{ url_for('signin') }}" method="POST" class="login__form" novalidate>
         <div class="login__header">
            <h1 class="login__title">Giriş Yap</h1>
            <p class="login__subtitle">Hesabınıza giriş yapın ve projelerinizi yönetin</p>
         </div>

         <div class="login__inputs">
            <div class="login__box">
               <input type="email" placeholder="Email Adresiniz" name="email" required class="login__input">
               <i class="ri-mail-fill"></i>
            </div>

            <div class="login__box">
               <input type="password" placeholder="İsminiz" name="password" required class="login__input">
               <i class="ri-user-fill"></i>
            </div>
         </div>

         <div class="login__check">
            <div class="login__check-box">
               <input type="checkbox" class="login__check-input" id="user-check">
               <label for="user-check" class="login__check-label">Beni Hatırla</label>
            </div>

            <a href="#" class="login__forgot">Şifremi Unuttum?</a>
         </div>

         <button type="submit" class="login__button">
            <i class="fas fa-sign-in-alt"></i>
            Giriş Yap
         </button>

         <div class="login__register">
            Hesabınız yok mu? <a href="{{ url_for('register') }}">Kayıt Ol</a>
         </div>
      </form>
   </div>

   {% with messages = get_flashed_messages() %}
      {% if messages %}
         <script>
            {% for message in messages %}
               showSuccessMessage("{{ message }}");
            {% endfor %}
         </script>
      {% endif %}
   {% endwith %}

   <style>
      /* Back to home button styling */
      .back-to-home {
         display: inline-flex;
         align-items: center;
         gap: 0.5rem;
         padding: 0.75rem 1.25rem;
         background: rgba(255, 255, 255, 0.1);
         backdrop-filter: blur(10px);
         border: 1px solid rgba(255, 255, 255, 0.2);
         border-radius: 0.75rem;
         color: white;
         text-decoration: none;
         font-weight: 500;
         transition: all 0.3s ease;
         font-size: 0.9rem;
      }

      .back-to-home:hover {
         background: rgba(255, 255, 255, 0.2);
         border-color: rgba(255, 255, 255, 0.3);
         transform: translateY(-2px);
         color: white;
      }

      [data-theme="dark"] .back-to-home {
         background: rgba(0, 0, 0, 0.2);
         border: 1px solid rgba(255, 255, 255, 0.1);
      }

      [data-theme="dark"] .back-to-home:hover {
         background: rgba(0, 0, 0, 0.3);
         border-color: rgba(255, 255, 255, 0.2);
      }

      /* Enhanced login form styling */
      .login__header {
         text-align: center;
         margin-bottom: 2rem;
      }

      .login__subtitle {
         color: rgba(255, 255, 255, 0.8);
         font-size: 0.9rem;
         margin-top: 0.5rem;
         margin-bottom: 0;
      }

      [data-theme="dark"] .login__subtitle {
         color: rgba(255, 255, 255, 0.7);
      }

      .login__button {
         display: flex;
         align-items: center;
         justify-content: center;
         gap: 0.5rem;
      }

      .login__button i {
         font-size: 1rem;
      }

      /* Enhanced login box styling for better visibility */
      .login__box {
         position: relative;
         margin-bottom: 1.5rem;
      }

      .login__box i {
         color: rgba(255, 255, 255, 0.6);
      }

      .login__input:focus + i {
         color: #4F46E5;
      }

      [data-theme="dark"] .login__input:focus + i {
         color: #a78bfa;
      }

      /* Responsive improvements */
      @media (max-width: 768px) {
         .back-to-home {
            font-size: 0.8rem;
            padding: 0.5rem 1rem;
         }
         
         .theme-toggle-container {
            scale: 0.9;
         }
      }
   </style>

   <script>
      // Theme Management
      function initializeTheme() {
         const savedTheme = localStorage.getItem('theme') || 'light';
         document.documentElement.setAttribute('data-theme', savedTheme);
      }

      function toggleTheme() {
         const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
         const newTheme = currentTheme === 'light' ? 'dark' : 'light';
         
         document.documentElement.setAttribute('data-theme', newTheme);
         localStorage.setItem('theme', newTheme);
         
         // Add smooth transition
         document.body.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
         setTimeout(() => {
            document.body.style.transition = '';
         }, 400);
         
         // Add ripple effect to toggle
         const toggle = document.querySelector('.theme-toggle');
         const ripple = document.createElement('div');
         ripple.classList.add('ripple');
         toggle.appendChild(ripple);
         
         setTimeout(() => {
            ripple.remove();
         }, 600);
      }

      // Initialize theme on page load
      initializeTheme();

      // Custom validation functions
      function showError(element, message) {
         // Remove existing error
         clearError(element);
         
         // Add error class to input box
         const inputBox = element.closest('.login__box');
         inputBox.classList.add('error');
         inputBox.style.position = 'relative';
         
         // Create error message element
         const errorDiv = document.createElement('div');
         errorDiv.className = 'error-message';
         errorDiv.textContent = message;
         
         // Add to input box
         inputBox.appendChild(errorDiv);
         
         // Show with animation
         setTimeout(() => {
            errorDiv.classList.add('show');
         }, 50);
      }

      function clearError(element) {
         const inputBox = element.closest('.login__box');
         inputBox.classList.remove('error');
         const existingError = inputBox.querySelector('.error-message');
         if (existingError) {
            existingError.remove();
         }
      }

      function showSuccessMessage(message) {
         const successDiv = document.createElement('div');
         successDiv.className = 'success-message';
         successDiv.textContent = message;
         document.body.appendChild(successDiv);
         
         setTimeout(() => {
            successDiv.classList.add('show');
         }, 100);
         
         setTimeout(() => {
            successDiv.classList.remove('show');
            setTimeout(() => {
               successDiv.remove();
            }, 400);
         }, 4000);
      }

      function validateEmail(email) {
         const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
         return emailRegex.test(email);
      }

      // Form validation
      document.addEventListener('DOMContentLoaded', function() {
         const form = document.querySelector('.login__form');
         const emailInput = document.querySelector('input[name="email"]');
         const passwordInput = document.querySelector('input[name="password"]');

         // Clear errors when user starts typing (after they've seen the error)
         [emailInput, passwordInput].forEach(input => {
            input.addEventListener('input', function() {
               clearError(this);
            });
         });

         // Form submit validation - only show errors when trying to submit
         form.addEventListener('submit', function(e) {
            let hasErrors = false;

            // Clear previous errors
            [emailInput, passwordInput].forEach(input => clearError(input));

            // Validate email
            if (!emailInput.value.trim()) {
               showError(emailInput, 'Email gereklidir');
               hasErrors = true;
            } else if (!validateEmail(emailInput.value)) {
               showError(emailInput, 'Geçerli bir email adresi girin');
               hasErrors = true;
            }

            // Validate password
            if (!passwordInput.value.trim()) {
               showError(passwordInput, 'İsim gereklidir');
               hasErrors = true;
            }

            if (hasErrors) {
               e.preventDefault();
            }
         });
      });
   </script>
</body>
</html>